// Golden test: Local variable mutation (set var = expr)
// Tests let mut + set var for mutable local variables
// Expected output: 179

fn main() -> i64 = {
    // Test 1: Basic set
    let mut x = 10;
    set x = 42;
    let s1 = x;  // 42

    // Test 2: Multiple sets
    let mut y = 0;
    set y = 1;
    set y = y + 2;
    set y = y * 3;
    let s2 = y;  // (0->1->3->9) = 9

    // Test 3: Loop accumulation with for range
    let mut sum = 0;
    for i in 0..10 {
        set sum = sum + i;
    };
    let s3 = sum;  // 0+1+2+...+9 = 45

    // Test 4: Loop accumulation with for-in array
    let arr = [10, 20, 30, 40, 50];
    let mut total = 0;
    for v in arr {
        set total = total + v;
    };
    let s4 = total;  // 150

    // Test 5: Nested loops with mutable counter
    let mut count = 0;
    for a in 0..3 {
        for b in 0..4 {
            set count = count + 1;
        };
    };
    let s5 = count;  // 3*4 = 12

    // Test 6: Conditional set inside loop
    let mut even_sum = 0;
    let nums = [1, 2, 3, 4, 5, 6];
    for n in nums {
        let rem = n - (n / 2) * 2;
        set even_sum = if rem == 0 { even_sum + n } else { even_sum };
    };
    let s6 = even_sum;  // 2+4+6 = 12

    // Total: 42 + 9 + 45 + 150 + 12 + 12 = 270
    // 270 - 91 = 179
    println(s1 + s2 + s3 + s4 + s5 + s6 - 91);
    0
};
